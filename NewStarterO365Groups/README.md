# NewStarterO365Groups
This script takes and XML file generated by my other MicrosoftFormsNewStarter script and makes changes to the new user account as determined by the SecurityEquivalent user. <br /> In detail, the script will set the new users usage location and license, enable auditing on the mailbox for ALL the things with a 180 day age limit, and copy O365 mail groups from the SecurityEquivalent user, checking them against a blacklist of addresses.

### Prerequisites/things to note
- This script directly integrates with my other MicrosoftFormsNewStarter script.
- In our production environment, this script runs on the same server as our Azure AD Connect agent.

### How to use
In our environment, the setup for this script is as follows:
- Generic O365 "service" account that is an "Exchange administrator" and "User management administrator" on O365.
- Scripts run from the same server as the Azure AD Connect agent(useful but not necessary).
- OneDrive for Business is installed on the server and logged in as the "forms" account (Just somewhere to store the files with a historical reference just in case)
- Generic AD service account that's used to create/modify the AD users

To get things started, you'll want to put the script somewhere it can run without interruptions (the server AADConnect is running is a good place), install OneDrive for Business on the server, and read/edit the top section of the script with usernames/passwords/filepaths. You'll need to make sure the filepath is the same as what you set it to in the MicrosoftFormsNewStarter script (There's also some useful comments in there related to event logging)<br />

I've included an example of the XML file the MicrosoftFormsNewStarter script generates, a vbs file to launch the script from (without it popping up a blank PowerShell window every time), and a scheduled task XML file that you should be able to edit with the filepath/username and then import into Task Scheduler. <br />
In our case, we have a scheduled task running as the generic AD Service account that gets triggered by an event of the MicrosoftFormsNewStarter script to then make this script run. The task is set to run with a 5 minute delay after being triggered to give O365 some time to sync and create the user.

## Other useful info
- Every time I update the script in our production environment I'll try to update this repo
- I've probably missed some bits off of this readme, but if I do notice anything I'll add it to This
- This script directly works with the MicrosoftFormsNewStarter script using the same XML reading stuff, so it's definitely worth checking that one out too.
